
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Ascenseur 3D Immersif</title>
  <style>
    body, html { margin: 0; padding: 0; overflow: hidden; height: 100%; }
    canvas { display: block; }
    #scene2 { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #111; color: white; text-align: center; padding-top: 20%; font-size: 2em; }
  </style>
</head>
<body>
  <canvas id="scene"></canvas>
  <div id="scene2">Bienvenue dans la nouvelle scène !</div>

  <script src="https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.min.js"></script>
  <script>
    let scene, camera, renderer, elevator, mixer, clock;
    let doorsOpen = false;

    // Initialisation de la scène
    function init() {
      scene = new THREE.Scene();
      camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('scene') });
      renderer.setSize(window.innerWidth, window.innerHeight);
      clock = new THREE.Clock();

      // Lumière
      const light = new THREE.PointLight(0xFFFFFF, 1, 100);
      light.position.set(0, 10, 0);
      scene.add(light);

      // Sol de l'ascenseur
      const floorGeometry = new THREE.PlaneGeometry(10, 10);
      const floorMaterial = new THREE.MeshBasicMaterial({ color: 0x555555 });
      const floor = new THREE.Mesh(floorGeometry, floorMaterial);
      floor.rotation.x = -Math.PI / 2;
      scene.add(floor);

      // Chargement du modèle 3D de l'ascenseur
      const loader = new THREE.GLTFLoader();
      loader.load('ascenseur.glb', function(gltf) {
        elevator = gltf.scene;
        mixer = new THREE.AnimationMixer(elevator);
        gltf.animations.forEach((clip) => mixer.clipAction(clip).play());
        scene.add(elevator);
        camera.position.set(0, 2, 5);
        animate();
      });
    }

    // Animation de la scène
    function animate() {
      requestAnimationFrame(animate);
      const delta = clock.getDelta();
      if (mixer) mixer.update(delta);
      renderer.render(scene, camera);
    }

    // Ouverture des portes de l'ascenseur
    function openDoors() {
      if (!doorsOpen) {
        doorsOpen = true;
        elevator.traverse((child) => {
          if (child.name === 'porteGauche' || child.name === 'porteDroite') {
            new TWEEN.Tween(child.rotation)
              .to({ y: Math.PI / 2 }, 1000)
              .easing(TWEEN.Easing.Quadratic.Out)
              .start();
          }
        });
      }
    }

    // Transition vers une nouvelle scène
    function transitionToScene2() {
      document.getElementById('scene2').style.display = 'block';
      document.getElementById('scene').style.display = 'none';
    }

    // Événement de clic pour ouvrir les portes et lancer la transition
    window.addEventListener('click', () => {
      openDoors();
      setTimeout(transitionToScene2, 2000); // Attendre 2 secondes avant la transition
    });

    // Initialisation
    init();
  </script>
</body>
</html>
