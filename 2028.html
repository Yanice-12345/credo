<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Dict√©e Interactive</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(270deg, #0f2027, #203a43, #2c5364);
      background-size: 600% 600%;
      animation: gradient 15s ease infinite;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 30px;
    }

    @keyframes gradient {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }

    .container {
      background: rgba(255, 255, 255, 0.08);
      padding: 30px;
      border-radius: 20px;
      max-width: 700px;
      width: 100%;
      backdrop-filter: blur(12px);
      box-shadow: 0 0 20px rgba(0,0,0,0.4);
    }

    h1 {
      text-align: center;
      font-size: 2em;
    }

    select, textarea, button {
      width: 100%;
      margin-top: 15px;
      padding: 15px;
      font-size: 1em;
      border-radius: 10px;
      border: none;
      outline: none;
    }

    button {
      background: #fff;
      color: #2c5364;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background: #2c5364;
      color: #fff;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    .button-row button {
      flex: 1 1 calc(50% - 10px);
    }

    #message {
      margin-top: 20px;
      font-size: 1.1em;
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìù Dict√©e Interactive</h1>
    <label for="textSelect">Choisissez une dict√©e :</label>
    <select id="textSelect">
      <option value="laboureur">Le laboureur et ses enfants</option>
      <option value="cigale">La Cigale et la Fourmi</option>
    </select>

    <div class="button-row">
      <button onclick="playDictation()">‚ñ∂Ô∏è √âcouter</button>
      <button onclick="pauseOrResumeDictation()">‚è∏Ô∏è Pause / Reprendre</button>
      <button onclick="slowDown()">üê¢ Ralentir</button>
      <button onclick="resetSpeed()">üöÄ Vitesse normale</button>
    </div>

    <textarea id="userInput" rows="10" placeholder="Tape ici ta dict√©e..."></textarea>
    <button onclick="checkDictation()">‚úÖ V√©rifier</button>
    <div id="message"></div>
  </div>

  <script>
    const dictations = {
      laboureur: `Travaillez, prenez de la peine :
C'est le fonds qui manque le moins.
Un riche Laboureur, sentant sa mort prochaine,
Fit venir ses enfants, leur parla sans t√©moins.
Gardez-vous, leur dit-il, de vendre l'h√©ritage
Que nous ont laiss√© nos parents.
Un tr√©sor est cach√© dedans.
Je ne sais pas l'endroit ; mais un peu de courage
Vous le fera trouver, vous en viendrez √† bout.
Remuez votre champ d√®s qu'on aura fait l'O√ªt.
Creusez, fouillez, b√™chez ; ne laissez nulle place
O√π la main ne passe et repasse.
Le p√®re mort, les fils vous retournent le champ
De√ß√†, del√†, partout ; si bien qu'au bout de l'an
Il en rapporta davantage.
D'argent, point de cach√©. Mais le p√®re fut sage
De leur montrer avant sa mort
Que le travail est un tr√©sor.`,

      cigale: `La Cigale, ayant chant√© Tout l'√©t√©,
Se trouva fort d√©pourvue Quand la bise fut venue : Pas un seul petit morceau De mouche ou de vermisseau.
Elle alla crier famine Chez la Fourmi sa voisine, La priant de lui pr√™ter Quelque grain pour subsister Jusqu'√† la saison nouvelle. ¬´ Je vous paierai, lui dit-elle, Avant l'ao√ªt, foi d'animal, Int√©r√™t et principal. ¬ª
La Fourmi n'est pas pr√™teuse : C'est l√† son moindre d√©faut.
¬´ Que faisiez-vous au temps chaud ? Dit-elle √† cette emprunteuse.
‚Äî Nuit et jour √† tout venant
Je chantais, ne vous d√©plaise.
‚Äî Vous chantiez ? j'en suis fort aise ; Eh bien dansez maintenant. ¬ª`
    };

    let utterance = null;
    let speechRate = 1;

    function getSelectedText() {
      const select = document.getElementById("textSelect");
      return dictations[select.value];
    }

    function convertPunctuation(text) {
      return text
        .replace(/:/g, " deux-points ")
        .replace(/;/g, " point-virgule ")
        .replace(/\./g, " point ")
        .replace(/,/g, " virgule ")
        .replace(/¬´/g, " ouvrez les guillemets ")
        .replace(/¬ª/g, " fermez les guillemets ")
        .replace(/‚Äî/g, " tiret ")
        .replace(/\?/g, " point d'interrogation ")
        .replace(/\!/g, " point d'exclamation ")
        .replace(/\n/g, ". ");
    }

    function playDictation() {
      const text = convertPunctuation(getSelectedText());
      if (!("speechSynthesis" in window)) {
        alert("La synth√®se vocale n'est pas disponible.");
        return;
      }

      speechSynthesis.cancel();
      utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = "fr-FR";
      utterance.rate = speechRate;

      // Choix voix masculine
      const voices = window.speechSynthesis.getVoices();
      const maleVoice = voices.find(v => v.lang.startsWith("fr") && v.name.toLowerCase().includes("homme"));
      if (maleVoice) utterance.voice = maleVoice;

      speechSynthesis.speak(utterance);
    }

    function pauseOrResumeDictation() {
      if (speechSynthesis.speaking) {
        if (speechSynthesis.paused) {
          speechSynthesis.resume();
        } else {
          speechSynthesis.pause();
        }
      }
    }

    function slowDown() {
      speechRate = Math.max(0.5, speechRate - 0.1);
      playDictation();
    }

    function resetSpeed() {
      speechRate = 1.0;
      playDictation();
    }

    function checkDictation() {
      const original = getSelectedText().replace(/\s+/g, " ").trim().toLowerCase();
      const user = document.getElementById("userInput").value.replace(/\s+/g, " ").trim().toLowerCase();
      const message = document.getElementById("message");

      if (user === original) {
        message.textContent = "‚úÖ Bravo ! Ta dict√©e est parfaitement correcte.";
        message.style.color = "#00e676";
      } else {
        message.textContent = "‚ùå Il y a des erreurs dans ta dict√©e. R√©√©coute et corrige-toi.";
        message.style.color = "#ff5252";
      }
    }

    // N√©cessaire sur certains navigateurs
    window.speechSynthesis.onvoiceschanged = () => {};
  </script>
</body>
</html>